---
layout: post
title: 什么是服务发现？
category: springcloud
tags: [springcloud]
excerpt: 服务发现
keywords: 微服务
---
## 什么是服务发现？

![](https://pinapple.gitee.io/assets/images/2020/springcloud/service-discovery.png)

- 服务提供者：服务的被调用方(为其他微服务提供接口的微服务)
- 服务消费者：服务的调用方(调用其他微服务的微服务)

```一种让服务消费者总能找到服务提供者的机制```

一般都用服务发现组件来实现服务发现，服务发现组件会提供一组API

/registry，提供者和消费者都会注册到服务发现组件

/cancel，微服务停止的时候调用，标记为DOWN

/heartbeat，心跳机制

### 服务发现原理

消费者想要调用提供者的时候，会去服务发现组件上请求可用的提供者。

现实情况下，每次调用都要去请求服务发现组件，会给服务发现组件造成很大压力。所以一般微服务会实现本地缓存，定时去请求服务发现组件，把可用的提供者缓存在本地，当去调用时，直接请求。这样一来，会提供性能，二是当服务发现组件挂了，微服务之间也能正常调用。

另外，服务发现组件会要求微服务向自己定时发送心跳，防止某个微服务突然挂了，来保证高可用。如果某个微服务长时间没有发送心跳，则会被标记为DOWN，微服务也会从本地缓存中清除不可用的提供者。